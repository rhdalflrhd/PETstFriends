<?xml version="1.0" encoding="UTf-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="dao.FreeBoardDao">

	<select id="selectOneBoard" parameterType="java.util.HashMap"
		resultType="freeBoard">
		select * from freeBoard where freeBoard_boardname =
		#{freeBoard_boardname} and freeBoard_boardno =#{freeBoard_boardno}

	</select>

	<!-- 파라미터타입 string 맞나? -->
	<select id="selectBoardbyId" parameterType="String" resultType="List">

		select * from freeBoard where freeBoard_boardname =
		#{freeBoard_boardname}
		and freeBoard_userId = #{freeBoard_userId}

	</select>

	<select id="selectBoardAll" parameterType="java.util.HashMap"
		resultType="freeBoard">
	select * from freeBoard where 1 = 1 and
		freeBoard_boardname = #{freeBoard_boardname}
		<if test="freeBoard_title != null">
			or freeBoard_title like '%${freeBoard_title}%' </if>
		<if test="freeBoard_cotent != null">
			or freeBoard_content like '%${freeBoard_content}%' </if>
		<if test="freeBoard_userId != null">
			or freeBoard_nickname like #{freeBoard_nickname }
		</if>
		<if test="startDate != null">
		   and writedate 
      	  between #{startDate} and #{endDate}
		</if>
         order by freeBoard_boardno desc limit #{skip},#{qty}
	</select>


	<select id="getCount" parameterType="java.util.HashMap"
		resultType="int">
		select count(*) from freeboard
		where 1 = 1 and
freeBoard_boardname = #{freeBoard_boardname}
		<if test="freeBoard_title != null">
			or freeBoard_title like '%${freeBoard_title}%'
		</if>
		<if test="freeBoard_content != null">
			or freeBoard_content like '%${freeBoard_content}%'
		</if>
		<if test="freeBoard_user_Id != null">
			or freeBoard_nickname  like '%${freeBoard_nickname}%'
		</if>

		<if test="freeBoard_startdate != null">
			and freeBoard_writeDate
			between #{startdate} and #{enddate}
		</if>
	</select>
	
	<sql id="freeBoard_title">
		<choose>
			<when test="freeBoard_title == null or freeBoard_title != '' ">
				#{freeBoard_title}
			</when>
			<otherwise>
				'제목없음'
			</otherwise>
		</choose>
	</sql>

	<sql id="freeBoard_content">
		<choose>
			<when test="freeBoard_content == null or freeBoard_content != ''">
				#{freeBoard_content}
			</when>
			<otherwise>
				'내용없음'
			</otherwise>
		</choose>
	</sql>
	<sql id="freeBoard_YoutubeUrl">
		<choose>
			<when test="freeBoard_YoutubeUrl != null">
				#{freeBoard_YoutubeUrl}
			</when>
			<otherwise>
				'동영상없음'
			</otherwise>
		</choose>
	</sql>



	<insert id="insertBoard" parameterType="java.util.HashMap"
		useGeneratedKeys="true" keyProperty="freeBoard_boardno">
		insert into freeBoard values (#{freeBoard_boardname},0,
		#{freeBoard_userId},#{freeBoard_nickname},
		<include refid="freeBoard_title" />
		, #{freeBoard_file},
		<include refid="freeBoard_content" />
		,
		curdate(),
		<include refid="freeBoard_YoutubeUrl" />
		,0, #{freeBoard_contentPic},0
		)
	</insert>

	<update id="updateBoard" parameterType="java.util.HashMap">
		update freeBoard set
		freeBoard_title=#{freeBoard_title},
		freeBoard_content=#{freeBoard_content},freeBoard_readCount=#{freeBoard_readCount}
		where freeBoard_boardname=#{freeBoard_boardname}
		and freeBoard_boardno=#{freeBoard_boardno}

	</update>

	<delete id="deleteBoard" parameterType="java.util.HashMap">

		delete from freeBoard
		where freeBoard_boardname=#{freeBoard_boardname}
		and freeBoard_boardno=#{freeBoard_boardno}

	</delete>

	<select id="getLastBoardno" resultType="int" parameterType="java.util.HashMap">
		select MAX(freeboard_boardno) from freeBoard where freeBoard_boardname
		= #{freeBoard_boardname} and freeBoard_userId=
		#{freeBoard_userId}
		<!-- 지금은 위에 커리로 해놓지만, 유저와 합치면 아래 코드로 바꿔야함 ㅇㅇ select MAX(tipboard_boardno) -->
	</select>




</mapper>